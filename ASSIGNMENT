#loading dataset
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
#defining dataframe
dataset=pd.read_csv("customer_churn_large_dataset.csv")
#structure of dataset
dataset.info()
dataset.tail()
dataset.isnull().sum()
dataset.columns
dataset.describe()
#checking fo duplicates
duplicate_rows=dataset[dataset.duplicated()]
print("duplicate rows based on all columns:")
print(duplicate_rows)
dataset.duplicated().sum()
#checking unique values :-
unique_CustomerID = dataset['CustomerID'].unique()
print("Unique CustmerID:",unique_CustomerID)
unique_Name = dataset['Name'].unique()
print("Unique Name:",unique_Name)
unique_Age= dataset['Age'].unique()
print("Unique  Age:",unique_Age)
unique_Gender= dataset['Gender'].unique()
print("Unique Gender:",unique_Gender)
unique_Location= dataset['Location'].unique()
print("Unique Location:",unique_Location)
unique_Subscription_Length_Months= dataset['Subscription_Length_Months'].unique()
print("Unique Subscription_Length_Months:",unique_Subscription_Length_Months)
unique_Monthly_Bill= dataset['Monthly_Bill'].unique()
print("Unique Monthly_Bill:",unique_Monthly_Bill)
unique_Total_Usage_GB= dataset['Total_Usage_GB'].unique()
print("Unique Total_Usage_GB:",unique_Total_Usage_GB)
unique_Churn= dataset['Churn'].unique()
print("Unique Churn:",unique_Churn)
from sklearn.preprocessing import LabelEncoder
enc=LabelEncoder()
dataset['CustomerID']=enc.fit_transform(dataset['CustomerID'].astype('str'))
dataset.head(5)

dataset['Name']=enc.fit_transform(dataset['Name'].astype('str'))
dataset.head(5)
dataset['Gender']=enc.fit_transform(dataset['Gender'].astype('str'))
dataset.head(5)
dataset['Location']=enc.fit_transform(dataset['Location'].astype('str'))
dataset.head(5)
dataset['Monthly_Bill']=enc.fit_transform(dataset['Monthly_Bill'].astype('str'))
dataset.head(5)
dataset
# Data Analysis and Visualization

# 1. Age Distribution
plt.figure(figsize=(8, 6))
sns.histplot(dataset['Age'], bins=30, kde=True)
plt.xlabel('Age')
plt.ylabel('Frequency')
plt.title('Age Distribution')
plt.show()

# 2. Gender Distribution
gender_counts = dataset['Gender'].value_counts()
plt.figure(figsize=(6, 6))
sns.barplot(x=gender_counts.index, y=gender_counts.values)
plt.xlabel('Gender')
plt.ylabel('Count')
plt.title('Gender Distribution')
plt.show()

# 3. Location Distribution
location_counts = dataset['Location'].value_counts()
plt.figure(figsize=(8, 6))
sns.barplot(x=location_counts.index, y=location_counts.values)
plt.xlabel('Location')
plt.ylabel('Count')
plt.title('Location Distribution')
plt.show()

# 4. Churn Rate
churn_counts = dataset['Churn'].value_counts()
plt.figure(figsize=(6, 6))
sns.barplot(x=churn_counts.index, y=churn_counts.values)
plt.xlabel('Churn')
plt.ylabel('Count')
plt.title('Churn Rate')
plt.show()
# 5. Monthly Bill vs. Age (scatter plot)
plt.figure(figsize=(10, 8))
sns.scatterplot(x='Age', y='Monthly_Bill', data=dataset, hue='Churn')
plt.xlabel('Age')
plt.ylabel('Monthly Bill')
plt.title('Monthly Bill vs. Age')
plt.show()
# 6. Total Usage vs. Monthly Bill (scatter plot)
plt.figure(figsize=(10, 8))
sns.scatterplot(x='Monthly_Bill', y='Total_Usage_GB', data=dataset, hue='Churn')
plt.xlabel('Monthly Bill')
plt.ylabel('Total Usage (GB)')
plt.title('Total Usage vs. Monthly Bill')
plt.show()

dataset['Avg_Monthly_Bill'] = dataset['Monthly_Bill'] / dataset['Subscription_Length_Months']

import pandas as pd

# Assuming you have your DataFrame named 'df'
# You can replace 'df' with your actual DataFrame variable name

# List of unnecessary columns to remove
columns_to_remove = ['CustomerID','Name','Location']

# Drop the unnecessary columns
dataset =dataset.drop(columns=columns_to_remove)

x=dataset.iloc[:,:-2]#features
x

y=dataset.iloc[:1]
y

from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import GaussianNB
from sklearn.metrics import classification_report, accuracy_score

#Split the dataset into training and testing sets:
X_train, X_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=100)

#Create and train a Gaussian Naive Bayes classifier:
nb = GaussianNB()
nb.fit(X_train, y_train)

#Make predictions on the test data:
y_pred = nb.predict(X_test)
print("Gaussian Naive Bayes Model accuracy(%) :", accuracy_score(y_test,y_pred)*100)

import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LinearRegression
from sklearn.metrics import mean_squared_error

# Assuming you have your DataFrame named 'df'
# You can replace 'df' with your actual DataFrame variable name

# Define the feature columns
feature_columns = ['Monthly_Bill', 'Total_Usage_GB']

# Define the target variable
target_column = 'Age'

# Split the data into training and testing sets
X = dataset[feature_columns]
y = dataset[target_column]
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Create and train a Linear Regression model
model = LinearRegression()
model.fit(X_train, y_train)

# Make predictions on the testing set
y_pred = model.predict(X_test)

# Evaluate the model
mse = mean_squared_error(y_test, y_pred)
print(f"Mean Squared Error: {mse}")
import pandas as pd
from sklearn.model_selection import train_test_split
from sklearn.naive_bayes import GaussianNB
from sklearn.tree import DecisionTreeClassifier
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, classification_report

# Load your DataFrame, encode categorical variables, and handle missing data as needed
# Replace 'df' with your actual DataFrame variable name

# Define feature columns and the target variable
feature_columns = ['Monthly_Bill', 'Total_Usage_GB']
target_column = 'Churn'

X = dataset[feature_columns]
y = dataset[target_column]

# Split the data into training and testing sets
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

# Create and train the models
models = {
    'Naive Bayes': GaussianNB(),
    'Decision Tree': DecisionTreeClassifier(),
    'Logistic Regression': LogisticRegression()
}

for model_name, model in models.items():
    model.fit(X_train, y_train)
    y_pred = model.predict(X_test)

    accuracy = accuracy_score(y_test, y_pred)
    report = classification_report(y_test, y_pred, target_names=['Not Churn', 'Churn'])

    print(f"Model: {model_name}")
    print(f"Accuracy: {accuracy:.2f}")
    print("Classification Report:")
    print(report)
    print("="*40)
